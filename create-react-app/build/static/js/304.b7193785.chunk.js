"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[304],{7304:function(e,t,a){a.r(t);var s=a(7313),r=a(9019),n=a(6835),l=a(3477),i=a(4076),o=a(7478),d=a(3467),c=a(1550),h=a(3306),u=a(8797),p=a(1405),x=a(8111),j=a(4631),Z=a(1095),g=a(3497),m=a(2401),v=a(6417);t.default=e=>{let{data:t,updateData:a}=e;const[y,f]=s.useState([]),[I,b]=s.useState([]),[w,C]=s.useState([]);s.useEffect((()=>(D(),S(),()=>{f([]),b([]),C([])})),[]);const D=()=>{fetch("/api/spares/sparesCategory").then((async e=>{if(!e.ok){const t=await e.text();throw new Error(t||e.statusText)}return e.json()})).then((e=>{f(e)})).catch((e=>{console.log(e.message)}))},S=()=>{fetch("/api/spares").then((async e=>{if(!e.ok){const t=await e.text();throw new Error(t||e.statusText)}return e.json()})).then((e=>{C(e)})).catch((e=>{console.log(e.message)}))},E=(e,s,r)=>{const n=[...t],l=n.findIndex((t=>t.sparesId===e));n[l][s]=r,"ADD"!==n[l].action&&(n[l].action="MODIFY"),a(n)},k=e=>{(async e=>{await fetch("/api/spares/findSparesInventoryWithFilter",{method:"POST",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((async e=>{if(!e.ok){const t=await e.text();throw new Error(t||e.statusText)}return e.json()})).then((e=>{console.log(e),b(e)})).catch((e=>{console.log(e.message)}))})({categoryList:[e]})};return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(g.Z,{title:"Job Spares Information",children:(0,v.jsx)(r.ZP,{container:!0,direction:"row",spacing:m.dv,children:(0,v.jsxs)(r.ZP,{item:!0,xs:12,children:[(0,v.jsx)("div",{style:{overflowX:"auto"},children:(0,v.jsxs)(n.Z,{style:{minWidth:1e3},children:[(0,v.jsx)(l.Z,{children:(0,v.jsxs)(i.Z,{children:[(0,v.jsx)(o.Z,{children:"Spares Category"}),(0,v.jsx)(o.Z,{children:"Spares"}),(0,v.jsx)(o.Z,{children:"Quantity"}),(0,v.jsx)(o.Z,{children:"Rate"}),(0,v.jsx)(o.Z,{children:"Amount"}),(0,v.jsx)(o.Z,{children:"Action"})]})}),(0,v.jsx)(d.Z,{children:t.filter((e=>"DELETE"!==e.action)).map((e=>(0,v.jsxs)(i.Z,{children:[(0,v.jsx)(o.Z,{children:(0,v.jsxs)(c.Z,{variant:"standard",sx:{m:1,minWidth:120},children:[(0,v.jsx)(h.Z,{id:"demo-simple-select-standard-label"}),(0,v.jsx)(u.Z,{fullWidth:!0,labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard-label",value:(null===e||void 0===e?void 0:e.category)||"",label:"Category Type",sx:{"& .MuiSelect-select":{color:"black"}},onChange:t=>{k(t.target.value),E(e.sparesId,"category",t.target.value)},children:y.map((e=>(0,v.jsx)(p.Z,{value:e.category,children:e.category},e.id)))})]})}),(0,v.jsx)(o.Z,{children:(0,v.jsx)(x.Z,{options:I.filter((e=>!t.some((t=>t.sparesId===e.id)))),getOptionLabel:e=>e.desc,style:{width:300},value:w.find((t=>t.desc===e.sparesAndLabour))||null,isOptionEqualToValue:(e,t)=>e.id===t.id,onChange:(t,a)=>{E(e.sparesId,"sparesAndLabour",a.desc),E(e.sparesId,"rate",a.sellRate),E(e.sparesId,"sparesId",a.id)},renderInput:t=>(0,v.jsx)(j.Z,{...t,label:"Search Spares",disabled:!!e.sparesId})})}),(0,v.jsx)(o.Z,{children:(0,v.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.qty)||"",onChange:t=>{const a=t.target.value;E(e.sparesId,"qty",a),E(e.sparesId,"amount",a*(null===e||void 0===e?void 0:e.rate)||0)},onBlur:t=>{const a=t.target.value;Number(a)<=0&&(alert("Quantity cannot be 0. Please delete the row if you want to remove the spare."),E(e.sparesId,"qty",""))}})}),(0,v.jsx)(o.Z,{children:(0,v.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.rate)||"",onChange:e=>E(index,"rate",e.target.value)})}),(0,v.jsx)(o.Z,{children:(0,v.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.amount)||"",onChange:t=>E(e.sparesId,"amount",t.target.value)})}),(0,v.jsx)(o.Z,{children:(0,v.jsx)(Z.Z,{variant:"contained",color:"error",onClick:()=>(e=>{const s=[...t],r=s.findIndex((t=>t.sparesId===e));"ADD"===s[r].action?s.splice(r,1):s[r].action="DELETE",a(s)})(e.sparesId),children:"Delete"})})]},e.sparesId||e.tempId)))})]})}),(0,v.jsxs)(r.ZP,{item:!0,xs:12,children:[(0,v.jsx)("br",{}),(0,v.jsx)(Z.Z,{variant:"contained",color:"error",onClick:()=>{a((e=>[...e,{sparesId:"",tempId:Date.now(),category:"",sparesAndLabour:"",qty:"",rate:"",amount:"",action:"ADD"}]))},children:"Add Row"})]})]})})})})}}}]);