"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[649],{4649:function(e,r,a){a.r(r),a.d(r,{default:function(){return E}});var t=a(7313),s=a(4096),i=a(9860),n=a(7458),l=a(6396),o=a(6149),d=a(4117),c=a(6467),h=a(1689),u=a(7131),x=a(3604),j=a(1550),m=a(3306),p=a(8797),b=a(1405),Z=a(1095),v=a(7829),g=a(1171),y=a(6417),f=(0,g.Z)((0,y.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"}),"OpenInNew"),P=a(9881),w=a(3984),C=a(1113),O=a(9019),S=a(4631),N=a(9536),k=a(2401);var z=function(e){let{open:r,onClose:a,job:u}=e;const[j,m]=t.useState({}),[p,b]=t.useState(!1),[v,g]=t.useState("");t.useEffect((()=>(f(u.id),()=>{m({})})),[u]);const f=e=>{fetch("/api/jobCard/jobSpares/"+e).then((async e=>{if(!e.ok){const r=await e.text();throw new Error(r||e.statusText)}return e.json()})).then((e=>{m(e)})).catch((e=>{console.log(e.message)}))},z=t.useMemo((()=>[{accessorKey:"complaints",header:"Complaints",size:250},{accessorKey:"completed",header:"Status",size:100},{accessorKey:"remarks",header:"Remarks",size:250}]),[]),I=t.useMemo((()=>[{accessorKey:"sparesAndLabour",header:"Spares/Labour",size:250},{accessorKey:"qty",header:"Quantity",size:100},{accessorKey:"rate",header:"Rate",size:100},{accessorKey:"amount",header:"Amount",size:100}]),[]),E=(0,i.Z)(),T=t.useMemo((()=>(0,n.Z)({palette:{mode:E.palette.mode,primary:E.palette.secondary,info:{main:"rgb(255,122,0)"},background:{default:"rgba(0, 0, 0, 0)"}},typography:{button:{textTransform:"none",fontSize:"1.2rem"}},components:{MuiTooltip:{styleOverrides:{tooltip:{fontSize:"1.1rem"}}},MuiSwitch:{styleOverrides:{thumb:{color:"pink"}}}}})),[E]),K="#faf4f3",M="#f2f0f6";return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(o.Z,{open:r,onClose:a,"aria-labelledby":"data-row-dialog-title",fullWidth:!0,maxWidth:"lg",children:[(0,y.jsx)(x.Z,{id:"data-row-dialog-title",children:(0,y.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,y.jsx)(C.Z,{variant:"h4",children:"JobCard: "+u.jobId+" VehicleNo.: "+u.vehicleRegNo}),(0,y.jsx)(h.Z,{title:"Download Jobcard",children:(0,y.jsx)(Z.Z,{onClick:()=>{fetch("/api/jobCard/pdf/"+u.id).then((async e=>{if(!e.ok){const r=await e.text();throw new Error(r||e.statusText)}return e.blob()})).then((e=>{const r=window.URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.setAttribute("download","Job_"+u.jobId+"_"+u.vehicleRegNo+".pdf"),document.body.appendChild(a),a.click(),a.parentNode.removeChild(a)})).catch((e=>{a(),console.log(e.message),g(e.message),b(!0)}))},children:"Print Jobcard"})}),(0,y.jsx)(h.Z,{title:"Print Bill",children:(0,y.jsx)(Z.Z,{onClick:()=>{fetch("/api/jobCard/billPdf/"+u.id).then((async e=>{if(!e.ok){const r=await e.text();throw new Error(r||e.statusText)}return e.blob()})).then((e=>{const r=window.URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.setAttribute("download","Bill_"+u.jobId+"_"+u.vehicleRegNo+".pdf"),document.body.appendChild(a),a.click(),a.parentNode.removeChild(a)})).catch((e=>{a(),console.log(e.message),g(e.message),b(!0)}))},children:"Print Bill"})})]})}),(0,y.jsxs)(c.Z,{dividers:!0,style:{backgroundColor:"white",color:"black"},children:[" ",(0,y.jsxs)(O.ZP,{container:!0,direction:"row",spacing:k.dv,children:[(0,y.jsx)(O.ZP,{item:!0,xs:12,children:(0,y.jsxs)(O.ZP,{container:!0,direction:"row",spacing:k.dv,children:[(0,y.jsx)(O.ZP,{item:!0,xs:6,children:(0,y.jsx)(S.Z,{label:"Owner Name",variant:"outlined",value:u.ownerName||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(O.ZP,{item:!0,xs:6,children:(0,y.jsx)(S.Z,{label:"Owner PhoneNumber",variant:"outlined",value:u.ownerPhoneNumber||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(O.ZP,{item:!0,xs:8,children:(0,y.jsx)(S.Z,{label:"Owner Address",fullWidth:!0,margin:"dense",multiline:!0,variant:"outlined",value:u.ownerAddress||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(O.ZP,{item:!0,xs:4,children:(0,y.jsx)(S.Z,{label:"Owner Email",fullWidth:!0,margin:"dense",variant:"outlined",value:u.ownerEmailId||"",InputProps:{readOnly:!0}})})]})}),(0,y.jsx)(O.ZP,{item:!0,xs:12,children:(0,y.jsx)(N.Z,{})}),(0,y.jsx)(O.ZP,{item:!0,xs:12,children:(0,y.jsxs)(O.ZP,{container:!0,direction:"row",spacing:k.dv,children:[(0,y.jsx)(O.ZP,{item:!0,xs:4,children:(0,y.jsx)(S.Z,{label:"Vehicle Reg. No.",variant:"outlined",value:u.vehicleRegNo||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(O.ZP,{item:!0,xs:4,children:(0,y.jsx)(S.Z,{label:"Vehicle Name",variant:"outlined",value:u.vehicleName||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(O.ZP,{item:!0,xs:4,children:(0,y.jsx)(S.Z,{label:"Vehicle Model",variant:"outlined",value:u.vehicleModel||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(O.ZP,{item:!0,xs:4,children:(0,y.jsx)(S.Z,{label:"Vehicle K.Ms",variant:"outlined",value:u.kiloMeters||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(O.ZP,{item:!0,xs:4,children:(0,y.jsx)(S.Z,{label:"Technician Name",variant:"outlined",value:u.technicianName||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(O.ZP,{item:!0,xs:4,children:(0,y.jsx)(S.Z,{label:"Driver Name",variant:"outlined",value:u.driver||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(O.ZP,{item:!0,xs:4,children:(0,y.jsx)(S.Z,{label:"Vehicle Out Date",variant:"outlined",value:u.vehicleOutDate||"",InputProps:{readOnly:!0}})})]})}),(0,y.jsx)(O.ZP,{item:!0,xs:12,children:(0,y.jsx)(N.Z,{})}),(0,y.jsx)(O.ZP,{item:!0,xs:12,children:(0,y.jsx)(l.Z,{theme:T,children:(0,y.jsx)(s.P2,{columns:z,data:u.jobInfo||[],muiTablePaperProps:{elevation:0,sx:{borderRadius:"0",background:`linear-gradient(195deg, ${K}, ${M})`}}})})}),(0,y.jsx)(O.ZP,{item:!0,xs:12,children:(0,y.jsx)(N.Z,{})}),(0,y.jsx)(O.ZP,{item:!0,xs:12,children:(0,y.jsx)(l.Z,{theme:T,children:(0,y.jsx)(s.P2,{columns:I,data:j.jobSparesInfo||[],muiTablePaperProps:{elevation:0,sx:{borderRadius:"0",background:`linear-gradient(195deg, ${K}, ${M})`}}})})}),(0,y.jsx)(O.ZP,{item:!0,xs:12,children:(0,y.jsx)(N.Z,{})}),(0,y.jsx)(O.ZP,{item:!0,xs:12,children:(0,y.jsx)(l.Z,{theme:T,children:(0,y.jsx)(s.P2,{columns:I,data:j.jobLaborInfo||[],muiTablePaperProps:{elevation:0,sx:{borderRadius:"0",background:`linear-gradient(195deg, ${K}, ${M})`}}})})}),(0,y.jsx)(O.ZP,{item:!0,xs:12,children:(0,y.jsx)(N.Z,{})}),(0,y.jsx)(O.ZP,{item:!0,xs:12,children:(0,y.jsxs)(O.ZP,{container:!0,direction:"row",spacing:k.dv,children:[(0,y.jsx)(O.ZP,{item:!0,xs:4,children:(0,y.jsx)(S.Z,{label:"Total Spares Value",variant:"outlined",value:j.totalSparesValue||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(O.ZP,{item:!0,xs:4,children:(0,y.jsx)(S.Z,{label:"Total Labour Value",variant:"outlined",value:j.totalLabourValue||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(O.ZP,{item:!0,xs:4,children:(0,y.jsx)(S.Z,{label:"Grand Total",variant:"outlined",value:j.grandTotal||"",InputProps:{readOnly:!0}})})]})})]})]}),(0,y.jsx)(d.Z,{children:(0,y.jsx)(Z.Z,{onClick:a,children:"Close"})})]}),(0,y.jsx)(o.Z,{open:p,onClose:()=>b(!1),"aria-labelledby":"data-row-dialog-title",fullWidth:!0,maxWidth:"lg",children:(0,y.jsx)(c.Z,{dividers:!0,style:{backgroundColor:"white",color:"black"},children:(0,y.jsx)(w.Z,{sx:{width:"100%"},spacing:2,children:(0,y.jsx)(P.Z,{variant:"filled",severity:"info",onClose:()=>b(!1),children:v})})})})]})};const I=e=>{let{cell:r}=e;return(0,y.jsx)(v.Z,{component:"span",sx:()=>({cursor:"pointer",backgroundColor:"OPEN"===r.getValue()?"green":"red",borderRadius:"0.35rem",maxWidth:"9ch",p:"0.25rem"}),children:r.getValue()})};var E=()=>{const[e,r]=(0,t.useState)([]),[a,g]=(0,t.useState)(!1),[C,O]=(0,t.useState)({}),[S,N]=(0,t.useState)(!1),[k,E]=t.useState(!1),[T,K]=t.useState("");(0,t.useEffect)((()=>(M(),()=>{r([]),g(!1),O({}),N(!1)})),[]);const M=()=>{fetch("/api/jobCard").then((async e=>{if(!e.ok){const r=await e.text();throw new Error(r||e.statusText)}return e.json()})).then((e=>{r(e)})).catch((e=>{console.log(e.message)}))},R=()=>{O({}),g(!1),N(!1)},L=async e=>{await fetch("/api/jobCard/jobStatus",{method:"PUT",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((async e=>{if(!e.ok){const r=await e.text();throw new Error(r||e.statusText)}return e.json()})).then((e=>{console.log(e),O({}),g(!1),M()})).catch((e=>{console.log(e.message),K(e.message),E(!0),O({}),g(!1)}))},V=(0,t.useMemo)((()=>[{accessorKey:"jobId",header:"Job Card No.",size:150},{accessorKey:"jobStatus",header:"Status",size:150,filterVariant:"select",filterSelectOptions:["OPEN","CLOSED","CANCELLED"],Header:(0,y.jsx)("i",{style:{color:"blue"},children:"Status"}),Cell:I,muiTableBodyCellProps:e=>{let{cell:r}=e;return{onClick:()=>{O(r.row.original),g(!0)}}}},{accessorKey:"invoiceId",header:"Invoice No.",size:150},{accessorKey:"ownerName",header:"Owner Name",size:150},{accessorKey:"ownerPhoneNumber",header:"Phone",size:200},{accessorKey:"vehicleRegNo",header:"Reg. No.",size:150},{accessorKey:"vehicleName",header:"Vehicle Name",size:150},{accessorKey:"vehicleModel",header:"Model",size:200},{accessorKey:"kiloMeters",header:"kiloMeters",size:150},{accessorKey:"jobCreationDate",header:"Job Open Date",size:150},{accessorKey:"jobCloseDate",header:"Job Closed Date",size:150},{accessorKey:"technicianName",header:"Technician",size:150},{accessorKey:"ownerAddress",header:"Address",size:150}]),[]),D=(0,i.Z)(),A=(0,t.useMemo)((()=>(0,n.Z)({palette:{mode:D.palette.mode,primary:D.palette.secondary,info:{main:"rgb(255,122,0)"},background:{default:"rgba(0, 0, 0, 0)"}},typography:{button:{textTransform:"none",fontSize:"1.2rem"}},components:{MuiTooltip:{styleOverrides:{tooltip:{fontSize:"1.1rem"}}},MuiSwitch:{styleOverrides:{thumb:{color:"pink"}}}}})),[D]);return(0,y.jsxs)("div",{children:[k&&(0,y.jsx)(w.Z,{sx:{width:"100%"},spacing:2,children:(0,y.jsx)(P.Z,{variant:"filled",severity:"info",onClose:()=>E(!1),children:T})}),(0,y.jsxs)(l.Z,{theme:A,children:[(0,y.jsx)(s.P2,{columns:V,data:e,editingMode:"modal",enableEditing:!0,initialState:{pagination:{pageSize:10}},muiTablePaperProps:{elevation:0,sx:{borderRadius:"0",background:"linear-gradient(195deg, #fff, #c38b81)"}},renderRowActions:e=>{let{row:r}=e;return(0,y.jsx)(v.Z,{sx:{display:"flex",gap:"1rem"},children:(0,y.jsx)(h.Z,{arrow:!0,placement:"right",title:"Open Job Card",children:(0,y.jsx)(u.Z,{onClick:()=>{O(r.original),N(!0)},children:(0,y.jsx)(f,{})})})})}})," "]}),(0,y.jsxs)(o.Z,{open:a,onClose:R,scroll:"paper","aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:[(0,y.jsx)(v.Z,{sx:{bgcolor:"#f44336",color:"#FFFFFF",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.75rem 1.25rem"},children:(0,y.jsx)(x.Z,{id:"scroll-dialog-title",sx:{flexGrow:1,fontSize:"1.5rem"},children:C.vehicleRegNo})}),(0,y.jsx)(c.Z,{dividers:"paper"===scroll,children:(0,y.jsxs)(j.Z,{variant:"outlined",style:{margin:"1px 0"},children:[(0,y.jsx)(m.Z,{children:"Job Status"}),(0,y.jsxs)(p.Z,{value:(null===C||void 0===C?void 0:C.jobStatus)||"",onChange:e=>{const r={...C,jobStatus:e.target.value};O(r)},label:"Status",children:[(0,y.jsx)(b.Z,{value:"CLOSED",children:"CLOSED"}),(0,y.jsx)(b.Z,{value:"OPEN",children:"OPEN"}),(0,y.jsx)(b.Z,{value:"CANCELLED",children:"CANCELLED"})]})]})}),(0,y.jsxs)(d.Z,{children:[(0,y.jsx)(Z.Z,{onClick:()=>{L(C),M(),R()},color:"primary",children:"Save"}),(0,y.jsx)(Z.Z,{onClick:R,color:"secondary",children:"Close"})]})]}),(0,y.jsx)(z,{open:S,onClose:R,job:C})]})}}}]);