"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[429],{1429:function(e,a,r){r.r(a),r.d(a,{default:function(){return L}});var t=r(7313),o=r(9546),s=r(4096),l=r(9860),n=r(7458),i=r(6396),d=r(1689),c=r(7131),u=r(6149),h=r(6467),m=r(9019),p=r(1113),x=r(1095),b=r(4117),j=r(4631),v=r(1207),y=r(1171),g=r(6417),Z=(0,y.Z)((0,g.jsx)("path",{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"}),"Build"),f=r(7829),w=r(2401),P=r(9881),C=r(3984);const N=(0,o.Z)((0,t.lazy)((()=>r.e(741).then(r.bind(r,1741))))),k=(0,o.Z)((0,t.lazy)((()=>r.e(67).then(r.bind(r,7812))))),S=(0,o.Z)((0,t.lazy)((()=>r.e(404).then(r.bind(r,4889))))),I=(0,o.Z)((0,t.lazy)((()=>Promise.all([r.e(111),r.e(304)]).then(r.bind(r,7304))))),A=(0,o.Z)((0,t.lazy)((()=>Promise.all([r.e(111),r.e(983)]).then(r.bind(r,1983))))),V=(0,o.Z)((0,t.lazy)((()=>r.e(914).then(r.bind(r,1914))))),E=(0,o.Z)((0,t.lazy)((()=>Promise.all([r.e(111),r.e(899)]).then(r.bind(r,2899)))));var L=()=>{const[e,a]=(0,t.useState)([]),[r,o]=(0,t.useState)({}),[y,L]=(0,t.useState)({}),[T,z]=(0,t.useState)({}),[D,O]=(0,t.useState)({}),[M,W]=(0,t.useState)([...Array(1)].map((()=>({complaints:"",completed:"",remarks:""})))),[q,K]=(0,t.useState)(!1),[J,R]=(0,t.useState)({}),[U,_]=(0,t.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",amount:"",action:""})))),[G,H]=(0,t.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",amount:""})))),[F,B]=(0,t.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),[Q,X]=(0,t.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),[Y,$]=(0,t.useState)(!1),[ee,ae]=t.useState(!1),[re,te]=t.useState("");(0,t.useEffect)((()=>(oe(),()=>{a([])})),[]);const oe=()=>{fetch("/api/jobCard/status/OPEN").then((async e=>{if(!e.ok){const a=await e.text();throw new Error(a||e.statusText)}return e.json()})).then((e=>{a(e)})).catch((e=>{console.log(e.message)}))};const se=async e=>{await fetch("/api/jobCard",{method:"PUT",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((async e=>{if(!e.ok){const a=await e.text();throw new Error(a||e.statusText)}return e.json()})).then((e=>{console.log(e),de()})).catch((e=>{console.log(e.message)}))},le=e=>{var a;L(e),a=e.id,fetch("/api/jobCard/jobSpares/"+a).then((async e=>{if(!e.ok){const a=await e.text();throw new Error(a||e.statusText)}return e.json()})).then((e=>{_(e.jobSparesInfo),H(e.jobConsumablesInfo),B(e.jobLaborInfo),X(e.jobExternalWorkInfo);let a={totalSparesValue:e.totalSparesValue,totalConsumablesValue:e.totalConsumablesValue,totalLabourValue:e.totalLabourValue,totalExternalWorkValue:e.totalExternalWorkValue,grandTotal:e.grandTotal};R(a),$(!0)})).catch((e=>{console.log(e.message)}))},ne=e=>e.filter((e=>"DELETE"!==e.action)).reduce(((e,a)=>e+(Number(a.amount)||0)),0),ie=async e=>{await fetch("/api/jobCard/jobSpares",{method:"POST",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((async e=>{if(!e.ok){const a=await e.text();throw new Error(a||e.statusText)}return e.json()})).then((e=>{console.log(e),de()})).catch((e=>{de(),console.log(e.message),te(e.message),ae(!0)}))},de=()=>{K(!1),o({}),z({}),O({}),W([...Array(1)].map((()=>({complaints:"",completed:"",remarks:""})))),$(!1),L({}),_([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",amount:""})))),H([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),B([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),X([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),R({})},ce=(0,t.useMemo)((()=>[{accessorKey:"jobId",header:"Job Card No.",size:150},{accessorKey:"jobStatus",header:"Status",size:150,filterVariant:"select",filterSelectOptions:["OPEN","CLOSED","CANCELLED"]},{accessorKey:"ownerName",header:"Owner Name",size:150},{accessorKey:"ownerPhoneNumber",header:"Phone",size:200},{accessorKey:"vehicleRegNo",header:"Reg. No.",size:150},{accessorKey:"vehicleName",header:"Vehicle Name",size:150},{accessorKey:"vehicleModel",header:"Model",size:200},{accessorKey:"technicianName",header:"Technician Name",size:150}]),[]),ue=(0,l.Z)(),he=(0,t.useMemo)((()=>(0,n.Z)({palette:{mode:ue.palette.mode,primary:ue.palette.secondary,info:{main:"rgb(255,122,0)"},background:{default:"rgba(0, 0, 0, 0)"}},typography:{button:{textTransform:"none",fontSize:"1.2rem"}},components:{MuiTooltip:{styleOverrides:{tooltip:{fontSize:"1.1rem"}}},MuiSwitch:{styleOverrides:{thumb:{color:"pink"}}}}})),[ue]);function me(){return(0,g.jsx)("hr",{style:{color:"#000000",backgroundColor:"#000000",height:1,borderColor:"#000000"}})}return(0,g.jsxs)("div",{children:[(0,g.jsxs)(i.Z,{theme:he,children:[(0,g.jsx)(s.P2,{columns:ce,data:e,editingMode:"modal",enableEditing:!0,muiTablePaperProps:{elevation:0,sx:{borderRadius:"0",background:"linear-gradient(195deg, #e2d7d5, #4f4563)"}},renderRowActions:e=>{let{row:a}=e;return(0,g.jsxs)(f.Z,{sx:{display:"flex",gap:"1rem"},children:[(0,g.jsx)(d.Z,{arrow:!0,placement:"left",title:"Update Job Info",children:(0,g.jsx)(c.Z,{onClick:()=>{(e=>{let a={vehicleRegNo:e.vehicleRegNo,vehicleName:e.vehicleName,vehicleModel:e.vehicleModel,kiloMeters:e.kiloMeters,technicianName:e.technicianName,vehicleOutDate:e.vehicleOutDate,fuelPoints:e.fuelPoints,driver:e.driver,cover:e.cover,glass:e.glass,dashboardAndTools:e.dashboardAndTools,spareWheel:e.spareWheel,jackeyHandles:e.jackeyHandles,toolKits:e.toolKits,penDrive:e.penDrive,wheelCap:e.wheelCap,acGrills:e.acGrills},r={ownerName:e.ownerName,ownerAddress:e.ownerAddress,ownerPhoneNumber:e.ownerPhoneNumber,ownerEmailId:e.ownerEmailId};o(e),z(r),O(a),W(e.jobInfo),K(!0)})(a.original)},children:(0,g.jsx)(v.Z,{})})}),(0,g.jsx)(d.Z,{arrow:!0,placement:"right",title:"Update Job Spares",children:(0,g.jsx)(c.Z,{onClick:()=>{le(a.original)},children:(0,g.jsx)(Z,{})})})]})}})," "]}),(0,g.jsx)("br",{}),(0,g.jsxs)(u.Z,{open:q,onClose:de,"aria-labelledby":"data-row-dialog-title",fullWidth:!0,maxWidth:"lg",children:[(0,g.jsxs)(h.Z,{dividers:!0,style:{backgroundColor:"white",color:"black"},children:[" ",(0,g.jsx)(m.ZP,{container:!0,spacing:w.dv,children:(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsxs)(m.ZP,{container:!0,spacing:w.dv,children:[(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(me,{})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(p.Z,{variant:"h2",children:"Updating JobCard: "+r.jobId+" VehicleNo.: "+r.vehicleRegNo})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(S,{data:M,updateData:W})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(k,{data:D,updateData:O})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(N,{data:T,updateData:z})}),(0,g.jsx)(m.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:T.ownerName&&T.ownerAddress&&T.ownerPhoneNumber&&D.vehicleRegNo&&D.vehicleName&&D.vehicleModel&&D.kiloMeters&&D.fuelPoints&&(console.log(JSON.stringify(M)),M[0].complaints)&&(0,g.jsx)(x.Z,{variant:"contained",color:"error",onClick:()=>{const e={id:r.id,jobId:r.jobId,jobStatus:r.jobStatus,jobCreationDate:r.jobCreationDate,ownerName:T.ownerName,ownerAddress:T.ownerAddress,ownerPhoneNumber:T.ownerPhoneNumber,ownerEmailId:T.ownerEmailId,vehicleRegNo:D.vehicleRegNo,vehicleName:D.vehicleName,vehicleModel:D.vehicleModel,kiloMeters:D.kiloMeters,fuelPoints:D.fuelPoints,technicianName:D.technicianName,driver:D.driver,vehicleOutDate:D.vehicleOutDate,cover:D.cover,glass:D.glass,dashboardAndTools:D.dashboardAndTools,spareWheel:D.spareWheel,jackeyHandles:D.jackeyHandles,toolKits:D.toolKits,penDrive:D.penDrive,wheelCap:D.wheelCap,acGrills:D.acGrills,jobInfo:M};se(e)},children:"Update JobCard"})}),(0,g.jsx)(m.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:(0,g.jsx)(x.Z,{variant:"contained",color:"error",onClick:de,children:"Cancel UpdateJobInfo"})})]})})})]}),(0,g.jsx)(b.Z,{children:(0,g.jsx)(x.Z,{onClick:de,children:"Close"})})]}),(0,g.jsx)("br",{}),(0,g.jsxs)(u.Z,{open:Y,onClose:de,"aria-labelledby":"data-row-dialog-title",fullWidth:!0,maxWidth:"lg",children:[(0,g.jsxs)(h.Z,{dividers:!0,style:{backgroundColor:"white",color:"black"},children:[" ",(0,g.jsx)(m.ZP,{container:!0,spacing:w.dv,children:(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsxs)(m.ZP,{container:!0,spacing:w.dv,children:[(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(me,{})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(p.Z,{variant:"h2",children:"Updating Spares for JobCard: "+y.jobId+" VehicleNo.: "+y.vehicleRegNo})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(I,{data:U,updateData:_})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(V,{data:G,updateData:H})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(A,{data:F,updateData:B})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(E,{data:Q,updateData:X})}),(0,g.jsx)(m.ZP,{item:!0,xs:2,children:(0,g.jsx)(j.Z,{label:"Total Spares Value",required:!0,variant:"outlined",value:J.totalSparesValue||"",InputProps:{readOnly:!0}})}),(0,g.jsx)(m.ZP,{item:!0,xs:2,children:(0,g.jsx)(j.Z,{label:"Total Consumables Value",required:!0,variant:"outlined",value:J.totalConsumablesValue||"",InputProps:{readOnly:!0}})}),(0,g.jsx)(m.ZP,{item:!0,xs:2,children:(0,g.jsx)(j.Z,{label:"Total Labour Value",required:!0,variant:"outlined",value:J.totalLabourValue||"",InputProps:{readOnly:!0}})}),(0,g.jsx)(m.ZP,{item:!0,xs:2,children:(0,g.jsx)(j.Z,{label:"Total ExternalWork Value",required:!0,variant:"outlined",value:J.totalExternalWorkValue||"",InputProps:{readOnly:!0}})}),(0,g.jsx)(m.ZP,{item:!0,xs:4,children:(0,g.jsx)(j.Z,{label:"Grand Total",required:!0,variant:"outlined",value:J.grandTotal||"",InputProps:{readOnly:!0}})})]})})})]}),(0,g.jsx)(b.Z,{children:(0,g.jsxs)(m.ZP,{container:!0,spacing:w.dv,children:[(0,g.jsx)(m.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:function(){var e,a,r,t;return(null===(e=U[0])||void 0===e?void 0:e.sparesAndLabour)||(null===G||void 0===G||null===(a=G[0])||void 0===a?void 0:a.sparesAndLabour)||(null===(r=F[0])||void 0===r?void 0:r.sparesAndLabour)||(null===Q||void 0===Q||null===(t=Q[0])||void 0===t?void 0:t.sparesAndLabour)}()&&(0,g.jsx)(x.Z,{variant:"contained",color:"error",onClick:()=>{const e=ne(U);(e=>{const a={...J,totalSparesValue:e};R(a)})(e);const a=ne(G);(e=>{const a={...J,totalConsumablesValue:e};R(a)})(a);const r=ne(F);(e=>{const a={...J,totalLabourValue:e};R(a)})(r);const t=ne(Q);(e=>{const a={...J,totalExternalWorkValue:e};R(a)})(t);const o=e+a+r+t;(e=>{const a={...J,grandTotal:e};R(a)})(o);const s={id:y.id,jobId:y.jobId,jobSparesInfo:U,jobConsumablesInfo:G,jobLaborInfo:F,jobExternalWorkInfo:Q,totalSparesValue:e,totalConsumablesValue:a,totalLabourValue:r,totalExternalWorkValue:t,grandTotal:o};ie(s)},children:"Update JobSpares"})}),(0,g.jsx)(m.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:(0,g.jsx)(x.Z,{variant:"contained",color:"error",onClick:de,children:"Cancel Update Spares"})})]})})]}),(0,g.jsx)(u.Z,{open:ee,onClose:()=>ae(!1),"aria-labelledby":"data-row-dialog-title",fullWidth:!0,maxWidth:"lg",children:(0,g.jsx)(h.Z,{dividers:!0,style:{backgroundColor:"white",color:"black"},children:(0,g.jsx)(C.Z,{sx:{width:"100%"},spacing:2,children:(0,g.jsx)(P.Z,{variant:"filled",severity:"info",onClose:()=>ae(!1),children:re})})})})]})}},1207:function(e,a,r){var t=r(1171),o=r(6417);a.Z=(0,t.Z)((0,o.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit")}}]);