"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[429],{1429:function(e,a,r){r.r(a),r.d(a,{default:function(){return k}});var t=r(7313),o=r(9546),s=r(4096),n=r(9860),i=r(7458),l=r(6396),c=r(1689),d=r(7131),h=r(9019),u=r(1113),m=r(1095),p=r(4631),j=r(1207),x=r(1171),b=r(6417),v=(0,x.Z)((0,b.jsx)("path",{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"}),"Build"),g=r(7829),y=r(2401),Z=r(9881),f=r(3984);const w=(0,o.Z)((0,t.lazy)((()=>r.e(741).then(r.bind(r,1741))))),N=(0,o.Z)((0,t.lazy)((()=>r.e(67).then(r.bind(r,7812))))),P=(0,o.Z)((0,t.lazy)((()=>r.e(404).then(r.bind(r,4889))))),S=(0,o.Z)((0,t.lazy)((()=>Promise.all([r.e(111),r.e(304)]).then(r.bind(r,7304))))),C=(0,o.Z)((0,t.lazy)((()=>r.e(983).then(r.bind(r,1983)))));var k=()=>{const[e,a]=(0,t.useState)([]),[r,o]=(0,t.useState)(),[x,k]=(0,t.useState)(),[I,T]=(0,t.useState)({}),[A,L]=(0,t.useState)({}),[M,z]=(0,t.useState)([...Array(1)].map((()=>({complaints:"",completed:"",remarks:""})))),[O,D]=(0,t.useState)(!1),[V,E]=(0,t.useState)({}),[K,R]=(0,t.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",amount:""})))),[U,J]=(0,t.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),[_,q]=(0,t.useState)(!1),[G,H]=t.useState(!1),[W,F]=t.useState("");(0,t.useEffect)((()=>(B(),()=>{a([])})),[]);const B=()=>{fetch("/api/jobCard/status/OPEN").then((async e=>{if(!e.ok){const a=await e.text();throw new Error(a||e.statusText)}return e.json()})).then((e=>{a(e)})).catch((e=>{console.log(e.message)}))};const Q=async e=>{await fetch("/api/jobCard",{method:"PUT",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((async e=>{if(!e.ok){const a=await e.text();throw new Error(a||e.statusText)}return e.json()})).then((e=>{console.log(e),ee()})).catch((e=>{console.log(e.message)}))},X=e=>{var a;k(e),a=e.id,fetch("/api/jobCard/jobSpares/"+a).then((async e=>{if(!e.ok){const a=await e.text();throw new Error(a||e.statusText)}return e.json()})).then((e=>{R(e.jobSparesInfo),J(e.jobLaborInfo);let a={totalSparesValue:e.totalSparesValue,totalLabourValue:e.totalLabourValue,grandTotal:e.grandTotal};E(a),q(!0)})).catch((e=>{console.log(e.message)}))},Y=e=>e.reduce(((e,a)=>e+(Number(a.amount)||0)),0),$=async e=>{await fetch("/api/jobCard/jobSpares",{method:"POST",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((async e=>{if(!e.ok){const a=await e.text();throw new Error(a||e.statusText)}return e.json()})).then((e=>{console.log(e),ae()})).catch((e=>{console.log(e.message),F(e.message),H(!0)}))},ee=()=>{D(!1),o({}),T({}),L({}),z([...Array(1)].map((()=>({complaints:"",completed:"",remarks:""}))))},ae=()=>{q(!1),k({}),R([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",amount:""})))),J([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),E({})},re=(0,t.useMemo)((()=>[{accessorKey:"jobId",header:"Job Card No.",size:150},{accessorKey:"jobStatus",header:"Status",size:150,filterVariant:"select",filterSelectOptions:["OPEN","CLOSED","CANCELLED"]},{accessorKey:"ownerName",header:"Owner Name",size:150},{accessorKey:"ownerPhoneNumber",header:"Phone",size:200},{accessorKey:"vehicleRegNo",header:"Reg. No.",size:150},{accessorKey:"vehicleName",header:"Vehicle Name",size:150},{accessorKey:"vehicleModel",header:"Model",size:200},{accessorKey:"technicianName",header:"Technician Name",size:150}]),[]),te=(0,n.Z)(),oe=(0,t.useMemo)((()=>(0,i.Z)({palette:{mode:te.palette.mode,primary:te.palette.secondary,info:{main:"rgb(255,122,0)"},background:{default:"rgba(0, 0, 0, 0)"}},typography:{button:{textTransform:"none",fontSize:"1.2rem"}},components:{MuiTooltip:{styleOverrides:{tooltip:{fontSize:"1.1rem"}}},MuiSwitch:{styleOverrides:{thumb:{color:"pink"}}}}})),[te]);function se(){return(0,b.jsx)("hr",{style:{color:"#000000",backgroundColor:"#000000",height:1,borderColor:"#000000"}})}return(0,b.jsxs)("div",{children:[(0,b.jsxs)(l.Z,{theme:oe,children:[(0,b.jsx)(s.P2,{columns:re,data:e,editingMode:"modal",enableEditing:!0,muiTablePaperProps:{elevation:0,sx:{borderRadius:"0",background:"linear-gradient(195deg, #e2d7d5, #4f4563)"}},renderRowActions:e=>{let{row:a}=e;return(0,b.jsxs)(g.Z,{sx:{display:"flex",gap:"1rem"},children:[(0,b.jsx)(c.Z,{arrow:!0,placement:"left",title:"Update Job Info",children:(0,b.jsx)(d.Z,{onClick:()=>{(e=>{let a={vehicleRegNo:e.vehicleRegNo,vehicleName:e.vehicleName,vehicleModel:e.vehicleModel,kiloMeters:e.kiloMeters,technicianName:e.technicianName,vehicleOutDate:e.vehicleOutDate,fuelPoints:e.fuelPoints,driver:e.driver,cover:e.cover,glass:e.glass,dashboardAndTools:e.dashboardAndTools,spareWheel:e.spareWheel,jackeyHandles:e.jackeyHandles,toolKits:e.toolKits,penDrive:e.penDrive,wheelCap:e.wheelCap,acGrills:e.acGrills},r={ownerName:e.ownerName,ownerAddress:e.ownerAddress,ownerPhoneNumber:e.ownerPhoneNumber,ownerEmailId:e.ownerEmailId};o(e),T(r),L(a),z(e.jobInfo),D(!0)})(a.original)},children:(0,b.jsx)(j.Z,{})})}),(0,b.jsx)(c.Z,{arrow:!0,placement:"right",title:"Update Spares",children:(0,b.jsx)(d.Z,{onClick:()=>{X(a.original)},children:(0,b.jsx)(v,{})})})]})}})," "]}),(0,b.jsx)("br",{}),(0,b.jsx)(h.ZP,{container:!0,spacing:y.dv,children:(0,b.jsx)(h.ZP,{item:!0,xs:12,children:O&&(0,b.jsxs)(h.ZP,{container:!0,spacing:y.dv,children:[(0,b.jsx)(h.ZP,{item:!0,xs:12,children:(0,b.jsx)(se,{})}),(0,b.jsx)(h.ZP,{item:!0,xs:12,children:(0,b.jsx)(u.Z,{variant:"h2",children:"Updating JobCard: "+r.jobId+" VehicleNo.: "+r.vehicleRegNo})}),(0,b.jsx)(h.ZP,{item:!0,xs:12,children:(0,b.jsx)(P,{data:M,updateData:z})}),(0,b.jsx)(h.ZP,{item:!0,xs:12,children:(0,b.jsx)(N,{data:A,updateData:L})}),(0,b.jsx)(h.ZP,{item:!0,xs:12,children:(0,b.jsx)(w,{data:I,updateData:T})}),(0,b.jsx)(h.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:I.ownerName&&I.ownerAddress&&I.ownerPhoneNumber&&A.vehicleRegNo&&A.vehicleName&&A.vehicleModel&&A.kiloMeters&&A.fuelPoints&&(console.log(JSON.stringify(M)),M[0].complaints)&&(0,b.jsx)(m.Z,{variant:"contained",color:"error",onClick:()=>{const e={id:r.id,jobId:r.jobId,jobStatus:r.jobStatus,jobCreationDate:r.jobCreationDate,ownerName:I.ownerName,ownerAddress:I.ownerAddress,ownerPhoneNumber:I.ownerPhoneNumber,ownerEmailId:I.ownerEmailId,vehicleRegNo:A.vehicleRegNo,vehicleName:A.vehicleName,vehicleModel:A.vehicleModel,kiloMeters:A.kiloMeters,fuelPoints:A.fuelPoints,technicianName:A.technicianName,driver:A.driver,vehicleOutDate:A.vehicleOutDate,cover:A.cover,glass:A.glass,dashboardAndTools:A.dashboardAndTools,spareWheel:A.spareWheel,jackeyHandles:A.jackeyHandles,toolKits:A.toolKits,penDrive:A.penDrive,wheelCap:A.wheelCap,acGrills:A.acGrills,jobInfo:M};Q(e)},children:"Update JobCard"})}),(0,b.jsx)(h.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:(0,b.jsx)(m.Z,{variant:"contained",color:"error",onClick:ee,children:"Cancel UpdateJobInfo"})})]})})}),(0,b.jsx)("br",{}),(0,b.jsx)(h.ZP,{container:!0,spacing:y.dv,children:(0,b.jsx)(h.ZP,{item:!0,xs:12,children:_&&(0,b.jsxs)(h.ZP,{container:!0,spacing:y.dv,children:[(0,b.jsx)(h.ZP,{item:!0,xs:12,children:(0,b.jsx)(se,{})}),(0,b.jsx)(h.ZP,{item:!0,xs:12,children:(0,b.jsx)(u.Z,{variant:"h2",children:"Updating Spares for JobCard: "+x.jobId+" VehicleNo.: "+x.vehicleRegNo})}),(0,b.jsx)(h.ZP,{item:!0,xs:12,children:(0,b.jsx)(S,{data:K,updateData:R})}),(0,b.jsx)(h.ZP,{item:!0,xs:12,children:(0,b.jsx)(C,{data:U,updateData:J})}),(0,b.jsx)(h.ZP,{item:!0,xs:4,children:(0,b.jsx)(p.Z,{label:"Total Spares Value",required:!0,variant:"outlined",value:V.totalSparesValue||"",InputProps:{readOnly:!0}})}),(0,b.jsx)(h.ZP,{item:!0,xs:4,children:(0,b.jsx)(p.Z,{label:"Total Labour Value",required:!0,variant:"outlined",value:V.totalLabourValue||"",InputProps:{readOnly:!0}})}),(0,b.jsx)(h.ZP,{item:!0,xs:4,children:(0,b.jsx)(p.Z,{label:"Grand Total",required:!0,variant:"outlined",value:V.grandTotal||"",InputProps:{readOnly:!0}})}),(0,b.jsx)(h.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:function(){var e,a;return(null===(e=K[0])||void 0===e?void 0:e.sparesAndLabour)||(null===(a=U[0])||void 0===a?void 0:a.sparesAndLabour)}()&&(0,b.jsx)(m.Z,{variant:"contained",color:"error",onClick:()=>{const e=Y(K);(e=>{const a={...V,totalSparesValue:e};E(a)})(e);const a=Y(U);(e=>{const a={...V,totalLabourValue:e};E(a)})(a);const r=e+a;(e=>{const a={...V,grandTotal:e};E(a)})(r);const t={id:x.id,jobId:x.jobId,jobSparesInfo:K,jobLaborInfo:U,totalSparesValue:e,totalLabourValue:a,grandTotal:r};$(t)},children:"Update JobSpares"})}),(0,b.jsx)(h.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:(0,b.jsx)(m.Z,{variant:"contained",color:"error",onClick:ae,children:"Cancel Update Spares"})})]})})}),G&&(0,b.jsx)(f.Z,{sx:{width:"100%"},spacing:2,children:(0,b.jsx)(Z.Z,{variant:"filled",severity:"info",onClose:()=>H(!1),children:W})})]})}},1207:function(e,a,r){var t=r(1171),o=r(6417);a.Z=(0,t.Z)((0,o.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit")}}]);