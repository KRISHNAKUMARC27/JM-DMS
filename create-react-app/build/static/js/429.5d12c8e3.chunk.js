"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[429],{1429:function(e,a,r){r.r(a),r.d(a,{default:function(){return z}});var o=r(7313),t=r(9546),s=r(4096),l=r(9860),n=r(7458),i=r(6396),d=r(1689),c=r(7131),u=r(6149),h=r(6467),m=r(9019),p=r(1113),b=r(1095),x=r(4117),j=r(4631),v=r(1207),y=r(1171),g=r(6417),Z=(0,y.Z)((0,g.jsx)("path",{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"}),"Build"),P=r(7829),f=r(2401),C=r(9881),w=r(3984),N=r(3483);const k=(0,t.Z)((0,o.lazy)((()=>r.e(741).then(r.bind(r,1741))))),S=(0,t.Z)((0,o.lazy)((()=>r.e(67).then(r.bind(r,7812))))),I=(0,t.Z)((0,o.lazy)((()=>r.e(404).then(r.bind(r,4889))))),A=(0,t.Z)((0,o.lazy)((()=>Promise.all([r.e(111),r.e(304)]).then(r.bind(r,7304))))),V=(0,t.Z)((0,o.lazy)((()=>Promise.all([r.e(111),r.e(983)]).then(r.bind(r,1983))))),L=(0,t.Z)((0,o.lazy)((()=>Promise.all([r.e(111),r.e(914)]).then(r.bind(r,1914))))),E=(0,t.Z)((0,o.lazy)((()=>Promise.all([r.e(111),r.e(899)]).then(r.bind(r,2899)))));var z=()=>{const[e,a]=(0,o.useState)([]),[r,t]=(0,o.useState)({}),[y,z]=(0,o.useState)({}),[D,M]=(0,o.useState)({}),[T,W]=(0,o.useState)({}),[O,q]=(0,o.useState)([...Array(1)].map((()=>({complaints:"",completed:"",remarks:""})))),[K,R]=(0,o.useState)(!1),[_,J]=(0,o.useState)({}),[U,G]=(0,o.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",amount:"",action:""})))),[H,B]=(0,o.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",amount:""})))),[F,Q]=(0,o.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),[X,Y]=(0,o.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),[$,ee]=(0,o.useState)(!1),[ae,re]=o.useState(!1),[oe,te]=o.useState("");(0,o.useEffect)((()=>(se(),()=>{a([])})),[]);const se=async()=>{try{const e=await(0,N.A_)("/api/jobCard/status/OPEN");a(e)}catch(e){console.error(e.message)}};const le=async e=>{try{await(0,N.GH)("/api/jobCard",e),ce()}catch(a){console.log(a.message),ce(),te(a.message),re(!0)}},ne=e=>{z(e),(async e=>{try{const a=await(0,N.A_)("/api/jobCard/jobSpares/"+e);G(a.jobSparesInfo),B(a.jobConsumablesInfo),Q(a.jobLaborInfo),Y(a.jobExternalWorkInfo);let r={totalSparesValue:a.totalSparesValue,totalConsumablesValue:a.totalConsumablesValue,totalLabourValue:a.totalLabourValue,totalExternalWorkValue:a.totalExternalWorkValue,grandTotal:a.grandTotal};J(r),ee(!0)}catch(a){console.error(a.message)}})(e.id)},ie=e=>e.filter((e=>"DELETE"!==e.action)).reduce(((e,a)=>e+(Number(a.amount)||0)),0),de=async e=>{try{await(0,N.j0)("/api/jobCard/jobSpares",e),ce()}catch(a){console.log(a.message),ce(),te(a.message),re(!0)}},ce=()=>{R(!1),t({}),M({}),W({}),q([...Array(1)].map((()=>({complaints:"",completed:"",remarks:""})))),ee(!1),z({}),G([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",amount:""})))),B([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),Q([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),Y([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0"})))),J({})},ue=(0,o.useMemo)((()=>[{accessorKey:"jobId",header:"Job Card No.",size:150},{accessorKey:"jobStatus",header:"Status",size:150,filterVariant:"select",filterSelectOptions:["OPEN","CLOSED","CANCELLED"]},{accessorKey:"ownerName",header:"Owner Name",size:150},{accessorKey:"ownerPhoneNumber",header:"Phone",size:200},{accessorKey:"vehicleRegNo",header:"Reg. No.",size:150},{accessorKey:"vehicleName",header:"Vehicle Name",size:150},{accessorKey:"vehicleModel",header:"Model",size:200},{accessorKey:"technicianName",header:"Technician Name",size:150}]),[]),he=(0,l.Z)(),me=(0,o.useMemo)((()=>(0,n.Z)({palette:{mode:he.palette.mode,primary:he.palette.secondary,info:{main:"rgb(255,122,0)"},background:{default:"rgba(0, 0, 0, 0)"}},typography:{button:{textTransform:"none",fontSize:"1.2rem"}},components:{MuiTooltip:{styleOverrides:{tooltip:{fontSize:"1.1rem"}}},MuiSwitch:{styleOverrides:{thumb:{color:"pink"}}}}})),[he]);function pe(){return(0,g.jsx)("hr",{style:{color:"#000000",backgroundColor:"#000000",height:1,borderColor:"#000000"}})}return(0,g.jsxs)("div",{children:[(0,g.jsxs)(i.Z,{theme:me,children:[(0,g.jsx)(s.P2,{columns:ue,data:e,editingMode:"modal",enableEditing:!0,muiTablePaperProps:{elevation:0,sx:{borderRadius:"0",background:"linear-gradient(195deg, #e2d7d5, #4f4563)"}},renderRowActions:e=>{let{row:a}=e;return(0,g.jsxs)(P.Z,{sx:{display:"flex",gap:"1rem"},children:[(0,g.jsx)(d.Z,{arrow:!0,placement:"left",title:"Update Job Info",children:(0,g.jsx)(c.Z,{onClick:()=>{(e=>{let a={vehicleRegNo:e.vehicleRegNo,vehicleName:e.vehicleName,vehicleModel:e.vehicleModel,kiloMeters:e.kiloMeters,technicianName:e.technicianName,vehicleOutDate:e.vehicleOutDate,fuelPoints:e.fuelPoints,driver:e.driver,cover:e.cover,glass:e.glass,dashboardAndTools:e.dashboardAndTools,spareWheel:e.spareWheel,jackeyHandles:e.jackeyHandles,toolKits:e.toolKits,penDrive:e.penDrive,wheelCap:e.wheelCap,acGrills:e.acGrills},r={ownerName:e.ownerName,ownerAddress:e.ownerAddress,ownerPhoneNumber:e.ownerPhoneNumber,ownerEmailId:e.ownerEmailId};t(e),M(r),W(a),q(e.jobInfo),R(!0)})(a.original)},children:(0,g.jsx)(v.Z,{})})}),(0,g.jsx)(d.Z,{arrow:!0,placement:"right",title:"Update Job Spares",children:(0,g.jsx)(c.Z,{onClick:()=>{ne(a.original)},children:(0,g.jsx)(Z,{})})})]})}})," "]}),(0,g.jsx)("br",{}),(0,g.jsxs)(u.Z,{open:K,onClose:ce,"aria-labelledby":"data-row-dialog-title",fullWidth:!0,maxWidth:"lg",children:[(0,g.jsxs)(h.Z,{dividers:!0,style:{backgroundColor:"white",color:"black"},children:[" ",(0,g.jsx)(m.ZP,{container:!0,spacing:f.dv,children:(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsxs)(m.ZP,{container:!0,spacing:f.dv,children:[(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(pe,{})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(p.Z,{variant:"h2",children:"Updating JobCard: "+r.jobId+" VehicleNo.: "+r.vehicleRegNo})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(I,{data:O,updateData:q})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(S,{data:T,updateData:W})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(k,{data:D,updateData:M})}),(0,g.jsx)(m.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:D.ownerName&&D.ownerAddress&&D.ownerPhoneNumber&&T.vehicleRegNo&&T.vehicleName&&T.vehicleModel&&T.kiloMeters&&T.fuelPoints&&(console.log(JSON.stringify(O)),O[0].complaints)&&(0,g.jsx)(b.Z,{variant:"contained",color:"error",onClick:()=>{const e={id:r.id,jobId:r.jobId,jobStatus:r.jobStatus,jobCreationDate:r.jobCreationDate,ownerName:D.ownerName,ownerAddress:D.ownerAddress,ownerPhoneNumber:D.ownerPhoneNumber,ownerEmailId:D.ownerEmailId,vehicleRegNo:T.vehicleRegNo,vehicleName:T.vehicleName,vehicleModel:T.vehicleModel,kiloMeters:T.kiloMeters,fuelPoints:T.fuelPoints,technicianName:T.technicianName,driver:T.driver,vehicleOutDate:T.vehicleOutDate,cover:T.cover,glass:T.glass,dashboardAndTools:T.dashboardAndTools,spareWheel:T.spareWheel,jackeyHandles:T.jackeyHandles,toolKits:T.toolKits,penDrive:T.penDrive,wheelCap:T.wheelCap,acGrills:T.acGrills,jobInfo:O};le(e)},children:"Update JobCard"})}),(0,g.jsx)(m.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:(0,g.jsx)(b.Z,{variant:"contained",color:"error",onClick:ce,children:"Cancel UpdateJobInfo"})})]})})})]}),(0,g.jsx)(x.Z,{children:(0,g.jsx)(b.Z,{onClick:ce,children:"Close"})})]}),(0,g.jsx)("br",{}),(0,g.jsxs)(u.Z,{open:$,onClose:ce,"aria-labelledby":"data-row-dialog-title",fullWidth:!0,maxWidth:"lg",children:[(0,g.jsxs)(h.Z,{dividers:!0,style:{backgroundColor:"white",color:"black"},children:[" ",(0,g.jsx)(m.ZP,{container:!0,spacing:f.dv,children:(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsxs)(m.ZP,{container:!0,spacing:f.dv,children:[(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(pe,{})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(p.Z,{variant:"h2",children:"Updating Spares for JobCard: "+y.jobId+" VehicleNo.: "+y.vehicleRegNo})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(A,{data:U,updateData:G})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(L,{data:H,updateData:B})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(V,{data:F,updateData:Q})}),(0,g.jsx)(m.ZP,{item:!0,xs:12,children:(0,g.jsx)(E,{data:X,updateData:Y})}),(0,g.jsx)(m.ZP,{item:!0,xs:2,children:(0,g.jsx)(j.Z,{label:"Total Spares Value",required:!0,variant:"outlined",value:_.totalSparesValue||"",InputProps:{readOnly:!0}})}),(0,g.jsx)(m.ZP,{item:!0,xs:2,children:(0,g.jsx)(j.Z,{label:"Total Consumables Value",required:!0,variant:"outlined",value:_.totalConsumablesValue||"",InputProps:{readOnly:!0}})}),(0,g.jsx)(m.ZP,{item:!0,xs:2,children:(0,g.jsx)(j.Z,{label:"Total Labour Value",required:!0,variant:"outlined",value:_.totalLabourValue||"",InputProps:{readOnly:!0}})}),(0,g.jsx)(m.ZP,{item:!0,xs:2,children:(0,g.jsx)(j.Z,{label:"Total ExternalWork Value",required:!0,variant:"outlined",value:_.totalExternalWorkValue||"",InputProps:{readOnly:!0}})}),(0,g.jsx)(m.ZP,{item:!0,xs:4,children:(0,g.jsx)(j.Z,{label:"Grand Total",required:!0,variant:"outlined",value:_.grandTotal||"",InputProps:{readOnly:!0}})})]})})})]}),(0,g.jsx)(x.Z,{children:(0,g.jsxs)(m.ZP,{container:!0,spacing:f.dv,children:[(0,g.jsx)(m.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:function(){var e,a,r,o;return(null===(e=U[0])||void 0===e?void 0:e.sparesAndLabour)||(null===H||void 0===H||null===(a=H[0])||void 0===a?void 0:a.sparesAndLabour)||(null===(r=F[0])||void 0===r?void 0:r.sparesAndLabour)||(null===X||void 0===X||null===(o=X[0])||void 0===o?void 0:o.sparesAndLabour)}()&&(0,g.jsx)(b.Z,{variant:"contained",color:"error",onClick:()=>{const e=ie(U);(e=>{const a={..._,totalSparesValue:e};J(a)})(e);const a=ie(H);(e=>{const a={..._,totalConsumablesValue:e};J(a)})(a);const r=ie(F);(e=>{const a={..._,totalLabourValue:e};J(a)})(r);const o=ie(X);(e=>{const a={..._,totalExternalWorkValue:e};J(a)})(o);const t=e+a+r+o;(e=>{const a={..._,grandTotal:e};J(a)})(t);const s={id:y.id,jobId:y.jobId,jobSparesInfo:U,jobConsumablesInfo:H,jobLaborInfo:F,jobExternalWorkInfo:X,totalSparesValue:e,totalConsumablesValue:a,totalLabourValue:r,totalExternalWorkValue:o,grandTotal:t};de(s)},children:"Update JobSpares"})}),(0,g.jsx)(m.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:(0,g.jsx)(b.Z,{variant:"contained",color:"error",onClick:ce,children:"Cancel Update Spares"})})]})})]}),(0,g.jsx)(u.Z,{open:ae,onClose:()=>re(!1),"aria-labelledby":"data-row-dialog-title",fullWidth:!0,maxWidth:"lg",children:(0,g.jsx)(h.Z,{dividers:!0,style:{backgroundColor:"white",color:"black"},children:(0,g.jsx)(w.Z,{sx:{width:"100%"},spacing:2,children:(0,g.jsx)(C.Z,{variant:"filled",severity:"info",onClose:()=>re(!1),children:oe})})})})]})}},1207:function(e,a,r){var o=r(1171),t=r(6417);a.Z=(0,o.Z)((0,t.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit")}}]);