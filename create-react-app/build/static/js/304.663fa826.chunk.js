"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[304],{7304:function(e,a,s){s.r(a);var t=s(7313),r=s(9019),n=s(6835),l=s(3477),d=s(4076),i=s(7478),o=s(3467),c=s(1550),u=s(3306),p=s(8797),h=s(1405),x=s(8111),j=s(4631),v=s(1095),Z=s(3497),m=s(2401),y=s(3483),g=s(6417);a.default=e=>{let{data:a,updateData:s}=e;const[I,f]=t.useState([]),[b,w]=t.useState([]),[C,D]=t.useState([]);t.useEffect((()=>(A(),S(),()=>{f([]),w([]),D([])})),[]);const A=async()=>{try{const e=await(0,y.A_)("/api/spares/sparesCategory");f(e)}catch(e){console.log(e.message)}},S=async()=>{try{const e=await(0,y.A_)("/api/spares");D(e)}catch(e){console.log(e.message)}},_=(e,t,r)=>{const n=[...a],l=n.findIndex((a=>a.sparesId===e));n[l][t]=r,"ADD"!==n[l].action&&(n[l].action="MODIFY"),s(n)},E=e=>{(async e=>{try{const a=await(0,y.j0)("/api/spares/findSparesInventoryWithFilter",e);w(a)}catch(a){console.log(a.message)}})({categoryList:[e]})};return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(Z.Z,{title:"Job Spares Information",children:(0,g.jsx)(r.ZP,{container:!0,direction:"row",spacing:m.dv,children:(0,g.jsxs)(r.ZP,{item:!0,xs:12,children:[(0,g.jsx)("div",{style:{overflowX:"auto"},children:(0,g.jsxs)(n.Z,{style:{minWidth:1e3},children:[(0,g.jsx)(l.Z,{children:(0,g.jsxs)(d.Z,{children:[(0,g.jsx)(i.Z,{children:"Spares Category"}),(0,g.jsx)(i.Z,{children:"Spares"}),(0,g.jsx)(i.Z,{children:"Quantity"}),(0,g.jsx)(i.Z,{children:"Rate"}),(0,g.jsx)(i.Z,{children:"Amount"}),(0,g.jsx)(i.Z,{children:"Action"})]})}),(0,g.jsx)(o.Z,{children:a.filter((e=>"DELETE"!==e.action)).map((e=>(0,g.jsxs)(d.Z,{children:[(0,g.jsx)(i.Z,{children:(0,g.jsxs)(c.Z,{variant:"standard",sx:{m:1,minWidth:120},children:[(0,g.jsx)(u.Z,{id:"demo-simple-select-standard-label"}),(0,g.jsx)(p.Z,{fullWidth:!0,labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard-label",value:(null===e||void 0===e?void 0:e.category)||"",label:"Category Type",sx:{"& .MuiSelect-select":{color:"black"}},onChange:a=>{E(a.target.value),_(e.sparesId,"category",a.target.value)},children:I.map((e=>(0,g.jsx)(h.Z,{value:e.category,children:e.category},e.id)))})]})}),(0,g.jsx)(i.Z,{children:(0,g.jsx)(x.Z,{options:b.filter((e=>!a.some((a=>a.sparesId===e.id)))),getOptionLabel:e=>e.desc,style:{width:300},value:C.find((a=>a.desc===e.sparesAndLabour))||null,isOptionEqualToValue:(e,a)=>e.id===a.id,onChange:(a,s)=>{_(e.sparesId,"sparesAndLabour",s.desc),_(e.sparesId,"rate",s.sellRate),_(e.sparesId,"amount",s.sellRate*(null===e||void 0===e?void 0:e.qty)||0),_(e.sparesId,"sparesId",s.id)},renderInput:a=>(0,g.jsx)(j.Z,{...a,label:"Search Spares",disabled:!!e.sparesId})})}),(0,g.jsx)(i.Z,{children:(0,g.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.qty)||"",onChange:a=>{const s=a.target.value;_(e.sparesId,"qty",s),_(e.sparesId,"amount",s*(null===e||void 0===e?void 0:e.rate)||0)},onBlur:a=>{const s=a.target.value;Number(s)<=0&&(alert("Quantity cannot be 0. Please delete the row if you want to remove the spare."),_(e.sparesId,"qty",""))}})}),(0,g.jsx)(i.Z,{children:(0,g.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.rate)||"",onChange:e=>_(index,"rate",e.target.value)})}),(0,g.jsx)(i.Z,{children:(0,g.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.amount)||"",onChange:a=>_(e.sparesId,"amount",a.target.value)})}),(0,g.jsx)(i.Z,{children:(0,g.jsx)(v.Z,{variant:"contained",color:"error",onClick:()=>(e=>{const t=[...a],r=t.findIndex((a=>a.sparesId===e));"ADD"===t[r].action?t.splice(r,1):t[r].action="DELETE",s(t)})(e.sparesId),children:"Delete"})})]},e.sparesId||e.tempId)))})]})}),(0,g.jsxs)(r.ZP,{item:!0,xs:12,children:[(0,g.jsx)("br",{}),(0,g.jsx)(v.Z,{variant:"contained",color:"error",onClick:()=>{s((e=>[...e,{sparesId:"",tempId:Date.now(),category:"",sparesAndLabour:"",qty:"",rate:"",amount:"",action:"ADD"}]))},children:"Add Row"})]})]})})})})}}}]);