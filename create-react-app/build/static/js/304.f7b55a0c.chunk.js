"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[304],{7304:function(e,t,s){s.r(t);var a=s(7313),r=s(9019),n=s(6835),l=s(3477),o=s(4076),i=s(7478),d=s(3467),c=s(1550),h=s(3306),u=s(8797),p=s(1405),x=s(8111),j=s(4631),g=s(1095),Z=s(3497),v=s(2401),m=s(6417);t.default=e=>{let{data:t,updateData:s}=e;const[y,f]=a.useState([]),[I,b]=a.useState([]),[w,C]=a.useState([]);a.useEffect((()=>(S(),D(),()=>{f([]),b([]),C([])})),[]);const S=()=>{fetch("http://localhost:8080/spares/sparesCategory").then((async e=>{if(!e.ok){const t=await e.text();throw new Error(t||e.statusText)}return e.json()})).then((e=>{f(e)})).catch((e=>{console.log(e.message)}))},D=()=>{fetch("http://localhost:8080/spares").then((async e=>{if(!e.ok){const t=await e.text();throw new Error(t||e.statusText)}return e.json()})).then((e=>{C(e)})).catch((e=>{console.log(e.message)}))},E=(e,a,r)=>{const n=[...t],l=n.findIndex((t=>t.sparesId===e));n[l][a]=r,"ADD"!==n[l].action&&(n[l].action="MODIFY"),s(n)},k=e=>{(async e=>{await fetch("http://localhost:8080/spares/findSparesInventoryWithFilter",{method:"POST",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((async e=>{if(!e.ok){const t=await e.text();throw new Error(t||e.statusText)}return e.json()})).then((e=>{console.log(e),b(e)})).catch((e=>{console.log(e.message)}))})({categoryList:[e]})};return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(Z.Z,{title:"Job Spares Information",children:(0,m.jsx)(r.ZP,{container:!0,direction:"row",spacing:v.dv,children:(0,m.jsxs)(r.ZP,{item:!0,xs:12,children:[(0,m.jsx)("div",{style:{overflowX:"auto"},children:(0,m.jsxs)(n.Z,{style:{minWidth:1e3},children:[(0,m.jsx)(l.Z,{children:(0,m.jsxs)(o.Z,{children:[(0,m.jsx)(i.Z,{children:"Spares Category"}),(0,m.jsx)(i.Z,{children:"Spares"}),(0,m.jsx)(i.Z,{children:"Quantity"}),(0,m.jsx)(i.Z,{children:"Rate"}),(0,m.jsx)(i.Z,{children:"Amount"}),(0,m.jsx)(i.Z,{children:"Action"})]})}),(0,m.jsx)(d.Z,{children:t.filter((e=>"DELETE"!==e.action)).map((e=>(0,m.jsxs)(o.Z,{children:[(0,m.jsx)(i.Z,{children:(0,m.jsxs)(c.Z,{variant:"standard",sx:{m:1,minWidth:120},children:[(0,m.jsx)(h.Z,{id:"demo-simple-select-standard-label"}),(0,m.jsx)(u.Z,{fullWidth:!0,labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard-label",value:(null===e||void 0===e?void 0:e.category)||"",label:"Category Type",sx:{"& .MuiSelect-select":{color:"black"}},onChange:t=>{k(t.target.value),E(e.sparesId,"category",t.target.value)},children:y.map((e=>(0,m.jsx)(p.Z,{value:e.category,children:e.category},e.id)))})]})}),(0,m.jsx)(i.Z,{children:(0,m.jsx)(x.Z,{options:I.filter((e=>!t.some((t=>t.sparesId===e.id)))),getOptionLabel:e=>e.desc,style:{width:300},value:w.find((t=>t.desc===e.sparesAndLabour))||null,isOptionEqualToValue:(e,t)=>e.id===t.id,onChange:(t,s)=>{console.log("new value is "+JSON.stringify(s)),E(e.sparesId,"sparesAndLabour",s.desc),E(e.sparesId,"rate",s.sellRate),E(e.sparesId,"sparesId",s.id)},renderInput:t=>(0,m.jsx)(j.Z,{...t,label:"Search Spares",disabled:!!e.sparesId})})}),(0,m.jsx)(i.Z,{children:(0,m.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.qty)||"",onChange:t=>{const s=t.target.value;s>0?(E(e.sparesId,"qty",s),E(e.sparesId,"amount",s*(null===e||void 0===e?void 0:e.rate)||0)):alert("Quantity cannot be 0. Please delete the row if you want to remove the spare.")}})}),(0,m.jsx)(i.Z,{children:(0,m.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.rate)||"",onChange:e=>E(index,"rate",e.target.value)})}),(0,m.jsx)(i.Z,{children:(0,m.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.amount)||"",onChange:t=>E(e.sparesId,"amount",t.target.value)})}),(0,m.jsx)(i.Z,{children:(0,m.jsx)(g.Z,{variant:"contained",color:"error",onClick:()=>(e=>{const a=[...t],r=a.findIndex((t=>t.sparesId===e));"ADD"===a[r].action?a.splice(r,1):a[r].action="DELETE",s(a)})(e.sparesId),children:"Delete"})})]},e.sparesId||e.tempId)))})]})}),(0,m.jsxs)(r.ZP,{item:!0,xs:12,children:[(0,m.jsx)("br",{}),(0,m.jsx)(g.Z,{variant:"contained",color:"error",onClick:()=>{s((e=>[...e,{sparesId:"",tempId:Date.now(),category:"",sparesAndLabour:"",qty:"",rate:"",amount:"",action:"ADD"}]))},children:"Add Row"})]})]})})})})}}}]);